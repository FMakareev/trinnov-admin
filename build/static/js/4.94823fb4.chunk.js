(window["webpackJsonptrinnov-dashboard"]=window["webpackJsonptrinnov-dashboard"]||[]).push([[4],{488:function(e,t,n){"use strict";n.r(t);var r=n(14),a=n(72),i=n.n(a),o=n(109),c=n(0),s=n.n(c),u=n(19),l=n(483),m=n(1),d=n(12),f=n(35),b=n(45),g=n(117),p=n(39),h=n(71),_=n(219),O=n(20),v=n(6),$=n(5),j=n(10),w=n(9),y=n(11),S=n(153),E=n(116),P=n(88),k=n(487),D=n(486);function N(){var e=Object(S.a)(['\n    mutation(\n        $id: String,\n        $title: String,\n        $slug: String,\n        $content: String,\n        $head_image: String,\n        $thumbnail: String,\n        $og_thumbnail: String,\n        $og_description: String,\n        $card_description: String,\n        $is_featured: String,\n        $thumbnail_featured: String,\n        $with_video: String,\n    ) {\n        createArticles(input: {\n            id: $id\n            title: $title\n            slug: $slug\n            content: $content\n            head_image: $head_image\n            thumbnail: $thumbnail\n            og_thumbnail: $og_thumbnail\n            og_description: $og_description\n            card_description: $card_description\n            is_featured: $is_featured\n            thumbnail_featured: $thumbnail_featured\n            with_video: $with_video\n        })\n        @rest(\n            type: "','",\n            path: "/articles/",\n            method: "POST"\n            bodySerializer: "formData"\n        ) {\n            id\n            userId\n            completed\n            title\n        }\n    }\n']);return N=function(){return e},e}var x=Object(E.a)(N(),P.a.News);function I(){var e=Object(S.a)(['\n    mutation(\n        $id: String,\n        $title: String,\n        $slug: String,\n        $content: String,\n        $head_image: String,\n        $thumbnail: String,\n        $og_thumbnail: String,\n        $og_description: String,\n        $card_description: String,\n        $is_featured: String,\n        $thumbnail_featured: String,\n        $with_video: String,\n    ) {\n        createArticles(input: {\n            id: $id\n            title: $title\n            slug: $slug\n            content: $content\n            head_image: $head_image\n            thumbnail: $thumbnail\n            og_thumbnail: $og_thumbnail\n            og_description: $og_description\n            card_description: $card_description\n            is_featured: $is_featured\n            thumbnail_featured: $thumbnail_featured\n            with_video: $with_video\n        })\n        @rest(\n            type: "','",\n            path: "/articles/",\n            method: "POST"\n            bodySerializer: "formData"\n        ) {\n            id\n            userId\n            completed\n            title\n        }\n    }\n']);return I=function(){return e},e}var R=Object(E.a)(I(),P.a.News),J=n(89);function A(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function z(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?A(n,!0).forEach(function(t){Object(r.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function C(){var e=Object(S.a)(['\n    query($slug: String!){\n        news(slug: $slug)\n        @rest(\n            type: "','",\n            path: "/articles/{args.slug}/",\n        ){\n            id\n            title\n            slug\n            content\n            head_image\n            thumbnail\n            og_thumbnail\n            og_description\n            card_description\n            is_featured\n            thumbnail_featured\n            with_video\n        }\n    }\n']);return C=function(){return e},e}var V=Object(E.a)(C(),P.a.News),q=Object(D.a)(Object(k.a)(V,{skip:function(e){var t=e.match;return!(t.params&&t.params.slug)},options:function(e){var t=e.match;return console.log("GetNewsQuery: ",t),{variables:{slug:t.params&&t.params.slug}}}}),Object(k.a)(R,{name:"CreateArticles"}),Object(k.a)(x,{name:"UpdateArticles"})),G=function(e){return q(function(t){function n(){var e,t;Object(v.a)(this,n);for(var a=arguments.length,c=new Array(a),s=0;s<a;s++)c[s]=arguments[s];return(t=Object(j.a)(this,(e=Object(w.a)(n)).call.apply(e,[this].concat(c)))).state={EditorRefInstance:null},t.transformData=function(e){var t=Object.assign({},e);return"string"!==typeof t.head_image&&(t.head_image=t.head_image&&t.head_image.file),"string"!==typeof t.og_thumbnail&&(t.og_thumbnail=t.og_thumbnail&&t.og_thumbnail.file),"string"!==typeof t.thumbnail&&(t.thumbnail=t.thumbnail&&t.thumbnail.file),"string"!==typeof t.thumbnail_featured&&(t.thumbnail_featured=t.thumbnail_featured&&t.thumbnail_featured.file),t.content&&(t.content=JSON.stringify(t.content)),null===t.is_featured&&(t.is_featured=!1),null===t.with_video&&(t.with_video=!1),t},t.onPublish=function(){var e=Object(o.a)(i.a.mark(function e(n){var a,o,c,s;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(console.log("onPublish: ",n),!n.id){e.next=12;break}return e.next=4,t.props.UpdateArticles({variables:z({},t.transformData(n))}).catch(function(e){return console.log(e),JSON.parse(JSON.stringify(e))});case 4:if(a=e.sent,o={},!a.networkError){e.next=10;break}return Object.entries(a.networkError.result).map(function(e){var t=Object(O.a)(e,2),n=t[0],r=t[1];o[n]=r[0]}),console.log(o),e.abrupt("return",z(Object(r.a)({},J.a,a.message),o));case 10:e.next=22;break;case 12:return e.next=14,t.props.CreateArticles({variables:z({},t.transformData(n))}).catch(function(e){return console.log(e),JSON.parse(JSON.stringify(e))});case 14:if(c=e.sent,console.log("onPublish create: ",c),s={},!c.networkError){e.next=21;break}return Object.entries(c.networkError.result).map(function(e){var t=Object(O.a)(e,2),n=t[0],r=t[1];s[n]=r[0]}),console.log(s),e.abrupt("return",z(Object(r.a)({},J.a,c.message),s));case 21:t.props.history.push("/news-editor/".concat(n.slug));case 22:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),t.onDraft=function(e){console.log("onDraft: ",e),t.transformData(e)},t}return Object(y.a)(n,t),Object($.a)(n,[{key:"render",value:function(){var t=this,n=this.props,r=n.data,a=n.match;return s.a.createElement(e,Object.assign({},this.props,{onPublish:this.onPublish,onDraft:this.onDraft,loading:r?r.loading:!(!a.params||!a.params.slug),EditorRefInstance:{EditorRefInstance:this.state.EditorRefInstance,addEditorRefInstance:function(e){t.setState({EditorRefInstance:e})}},initialValues:z({},r&&r.news?r.news:{is_featured:!1,with_video:!1})}))}}]),n}(s.a.Component))};function T(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function U(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?T(n,!0).forEach(function(t){Object(r.a)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):T(n).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var L=Object(l.a)(),Q=G(function(e){var t=e.onPublish,n=e.loading,r=e.initialValues,a=e.EditorRefInstance;return n?s.a.createElement("div",null,"Loading ..."):s.a.createElement(u.b,{onSubmit:function(){var e=Object(o.a)(i.a.mark(function e(n){var r;return i.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(r={},!a.EditorRefInstance){e.next=9;break}return e.next=4,a.EditorRefInstance.save();case 4:if(!(r=e.sent).blocks||r.blocks.length){e.next=7;break}return e.abrupt("return",{content:"Required"});case 7:e.next=10;break;case 9:return e.abrupt("return",{content:"Editor not initializing"});case 10:return e.abrupt("return",t(U({},n,{content:r})));case 11:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}(),decorators:[L],initialValues:r,render:function(e){var t=e.handleSubmit;return s.a.createElement("form",{onSubmit:function(e){return t(e)}},s.a.createElement(m.k,{fluid:!0,className:"main-content-container px-4"},s.a.createElement(m.J,{noGutters:!0,className:"page-header py-4"},s.a.createElement(d.a,{sm:"4",title:"News editor",subtitle:"Drag and drop interface",className:"text-sm-left"}),s.a.createElement("div",{className:"ml-auto"},s.a.createElement(m.c,{outline:!0,theme:"accent",size:"sm",className:"mr-2"},s.a.createElement("i",{className:"material-icons"},"save")," Save Draft"),s.a.createElement(m.c,{type:"submit",theme:"accent",size:"sm",className:"ml-auto"},s.a.createElement("i",{className:"material-icons"},"file_copy")," Publish"))),s.a.createElement(m.J,{className:"mb-4"},s.a.createElement(m.i,{lg:"9"},s.a.createElement(h.a,null),s.a.createElement(_.a,{EditorRefInstance:a})),s.a.createElement(m.i,{lg:"3"},s.a.createElement(f.a,null),s.a.createElement(b.a,null),s.a.createElement(g.a,null),s.a.createElement(p.a,null)))))}})});t.default=function(e){return s.a.createElement(Q,e)}}}]);
//# sourceMappingURL=4.94823fb4.chunk.js.map